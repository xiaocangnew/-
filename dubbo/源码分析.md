### 核心模块职责介绍
­ 1.container 运行容器api模块。
   定义了main方法；定义了容器接口Container，该接口包含了启动和停止方法定义；还有一些通用的分页功能的相关类。
   dubbo内置了javaconfig、jetty、log4j、logback和spring几种容器的实现。
   
- 2.registry 注册中心
   是consumer和provider两个重要角色的协调者。该项目定义了核心的注册中心接口和实现。具体实现留给了其它项目。
   - 注册方式：
   * zookeeper（默认）
   * redis（基于reids的发布/订阅
   * multicast(广播)
   * Simple注册中心
   
­ 3.rpc ­api 
   定义了rpc的一些抽象的rpc接口和实现类.包括服务发布，服务调用代理，远程调用结果及异常，rpc调用网络协议，rpc调用监听器和过滤器等等。
   该模块提供了默认的基于dubbo协议的实现模块，还提供了hessian、http、rest、rmi、thrift和webservice等协议的实现，还可以自己开发协议；
     - rpc协议 
     1.dubbo： 基于TCP的单一长连接和NIO异步通讯  适合大并发小数据量调用&&consumer>provider TCP协议  Hessian序列化；
     2.rmi：  Java二进制序列化  基于TCP的多个短连接同步传输，适合消费者和提供者数量差不多的情况，适用于文件的传输，一般较少用。
     3.webservice: 基于HTTP多个短连接同步传输，适用系统集成和跨语言调用；
     4.http： 基于Http多个短连接同步传输，使用Spring的HttpInvoke 实现。传入参数大小混合，提供者个数多于消费者，需要给应用程序和浏览器 JS 调用；
     5.hession: 基于HTTP多个短连接同步传输，适用于consumer<provider，适用于文件的传输，走hessian序列化协议， 一般较少用
     - 序列化
     1.dubbo序列化：阿里尚未开发成熟的高效java序列化实现，不建议在生产环境使用它
     2.hessian2序列化：hessian是一种跨语言的高效二进制序列化方式。但这里实际不是原生的hessian2序列化，而是阿里修改过的hessian lite，是dubbo RPC默认的序列化方式
     3.json序列化：目前有两种实现，一种是采用的阿里的fastjson库，另一种是采用dubbo中自己实现的简单json库，但都不是特别成熟，而且json这种文本序列化性能比1和2都差
     4.java序列化：主要是采用JDK自带的Java序列化实现，性能很不理想。
     5.专门针对Java语言的：Kryo，FST等等
     6.跨语言的：Protostuff，ProtoBuf，Thrift，Avro，MsgPack等等
     
­ 4.remoting 远程通讯模块。是对于远程网络通讯的抽象
   rpc的实现基础就是远程通讯，consmer要调用provider的远程方法必须通过网络远程通讯实现。
   定义了客户端、服务端、远程传输器、终端、编码解码器、数据交换、缓冲区、通讯异常定义等等核心的接口及类构成。
   提供了诸如netty、mina、grizzly、http、p2p和zookeeper的协议和技术框架的实现方式。
   
­ 5.monitor ­api 
    该模块是dubbo的监控模块，通过该模块可以监控服务调用的各种信息，例如调用耗时、调用量、调用结果等等，监控中心在调用过程中收集调用的信息，发送到监控服务，在监控服务中可以存储这些信息，对这些数据进行统计分析，最终可以产生各种维护的调用监控信息。dubbo默认提供了一个实现，该实现非常简单，只是作为默认的实现范例，生产环境使用价值不高，需要自行实现自己的监控。
­ 6.common 
   几乎所有dubbo模块都会使用到的一些通用与业务领域无关的工具类（io处理、日志处理、配置处理、类处理等等），线程池扩展、二进制代码处理、class编译处理、json处理、数据存储接口，系统版本号等等通用的类和接口。
­ 7.config ­api 
   从图中可以看出该模块依赖了几乎所有的其它模块，他是dubbo的配置模块，通过它的配置和组装将dubbo组件的多个模块整合在一起给最终的开发者提供有价值的分布式服务框架。
   定义了面向dubbo使用者的各种信息配置，比如服务发布配置、方法发布配置、服务消费配置、应用程序配置、注册中心配置、协议配置、监控配置等等。另外还有一个spring的配置模块，定义了一些spring的XML Schema，能够大大简化使用dubbo的配置，可以大大降低spring使用场景的学习和配置成本。
­ 8.cluster 集群模块 
   支持目录服务，注册中心就是目录服务的一种实现，
   支持负载均衡，
   实现了路由器特性，
   合并技术，当将调用请求分发给所有的服务提供者，则会返回多个结果，则将多个结果合并需要用到合并器的实现
   - 支持多种集群调用策略，包括failover,failsafe,failfast,failback,forking等。
   1.FailOver   失败切换服务器，通过retries=2,不含第一次，会增加时延
   2.FailFast   失败报错，通常用于非幂等
   3.FailSafe   失败异常忽略
   4.FailBack   失败自动重发，后台记录失败请求，定时重发
   5.Forking    并行调用多个服务器，只要一个成功就返回
 
­ 9.admin 
  该项目是一个web应用，可以独立部署，它可以管理dubbo服务，通过该管理应用可以连接注册中心，重点是读取注册中心中的信息，也可以通过该应用改写注册中心的信息，从而实现动态的管控服务。该模块的功能也非常简单，对于实际的生产使用场景，还需要对该应用的功能进行扩展和定制，以满足实际的使用场景。




### 工作流程
container启动 --> 服务通过dubbo的url发布到register --> 消费者到register订阅服务 -->  register不间断的heartbeat向消费者通知自己的服务注册消息
--> 消费者直接通过register获取服务的url并缓存起来，直接调用服务

https://baijiahao.baidu.com/s?id=1651785365950094625&wfr=spider&for=pc