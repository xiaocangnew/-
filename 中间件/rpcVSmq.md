### 对比
1. 对于要立即等待返回处理结果的同步调用场景，RPC是首选。
       异步rpc时，mq是一种很好的选择, 能保证最终一致性。
2. [上游-下游] 这种直接rpc的处理方式效率肯定是比[上游-MQ-下游]方式要高。
但是，当上游要依赖的下游数量很多&&弱依赖时， 使用mq会更好。
MQ效率高，是因为我只是把上游-MQ 这个阶段成功就当做全部成功了。

### mq的使用场景：
1. 注册后我们可能需要做很多初始化的操作，如：调用邮件服务器发送邮件、调用促销服务赠送优惠劵、下发用户数据到客户关系系统等。那么这时候我们将这些操作去监听MQ，当用户注册成功过后，通过MQ通知其他业务进行操作。确保注册用户的性能。 
2. 后台发布商品的时候，商品数据需要从数据库中转换成搜索引擎数据（基于elasticsearch），那么我们应该将商品写入数据库后，再写入到MQ，然后通过监听MQ来生成elasticsearch对应的数据。 
3. 用户下单后，24小时未支付，需要取消订单。以前我们可能是定时任务循环查询，然后取消订单。实际上，我更推荐类似延迟MQ的方式，避免了很多无效的数据库查询，将一个MQ设置为24小时后才让消费者消费掉，这样很大程度上能减轻服务器压力。 
4. 支付完成后，需要及时的通知子系统（进销存系统发货，用户服务积分，发送短信）进行下一步操作，但是，支付回调我们都是需要保证高性能的，所以，我应该直接修改数据库状态，存入MQ，让MQ通知子系统做其他非实时的业务操作。这样能保证核心业务的高效及时。
