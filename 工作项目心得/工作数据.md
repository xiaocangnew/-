### 都是在didi的jar包下实现拦截
1. 相关的jar包
common.controller   common.db    common.http-client common.log     common.metric      

### 统计数据监控
1. 下单tps：平均1， 峰值5(真实值0.4 2)， 80台机器；  下单延时：平均100ms，最小20ms，最大1000ms, 日订单量目前为200万主订单,(odin每分钟才1000，1000都偏大，真实是500-1000之间) 
   订单查询qps： 均值3， 峰值10(真实值0.8, 2)
   下单时调用其他http接口：平均延时40ms，
   mysql 针对tradeSubOrder， 平均插入/搜索 延时3ms，
   
2.  目前用户数量： 
    user查询接口，  qps：1000， tomcat线程池配了500
3.  商品查询接口，   qps：200，


### 日志监控
1. 通过全局Context 进行，在Http



### cpu监控， jvm监控




### mysql监控



### 限流，降级



#### dbproxy， 分库分表


### 灰度， 小流量


### 压测
使用线上压测， 数据库是单独区分的影子表， 用hintcode区分压测流量，添加在http的header里


### 分布式锁


### 商品库存扣减逻辑



### 中台
当前互联网技术架构领域对中台的认识不大相同，有“大中台”派系，也有“小中台”派系。
区别在于中台是否参与业务，做业务抽象，还是做工具抽象，做数据
各有各的道理，中台任务在于尽量抽象共性的功能下沉，已复用。那能抽象到那个程度则各公司各生态差异较大，不好一概而论。
那我们中台的设计思路是什么？中台边界是什么呢？边界原则：
交易中心维护交易链路的“全状态”（各系统需要状态向其同步），并作为仓储和售后的databus负责订单相关的任务流转。
交易中心负责 交易链路：
1. 下单强事务路径 — 生单、锁库存，锁卷，支付 ；
2. 支付成功回调弱事务路径 —— 异步执行减库存、消卷、异步传播消息给中台外其他系统 ｜异步执行解锁库存、解锁卷
3. 维护订单状态机：除了商场C端调用外，其他系统如售后（退货）、物流（缺货）需要订单相关信息同步给交易中心
4. 提供接口：提供一站式订单状态查询（包括退货、缺货等状态）
5. 驱动和订单相关的履约流程：售后系统和仓配不直接联系，缺货，退货等状态事件通过交易中心流转（根据内部状态，决定如何流转）
注：
状态同步方式：
来自用户行为变更（下单）同步rpc方式（需要应答）
来自售后、仓储的状态变更来自异步消息


交易中心不负责：
分佣计算任务
用户累计金额、积分等计算任务